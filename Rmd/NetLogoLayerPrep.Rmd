---
title: "NetLogoLayerPrep"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Libraries
```{r libraries}
rm(list=ls())
library(raster)
library(sf)

```

```{r data}
new_crs <- "+proj=aea +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
pp1_shp <- read_sf("../Circuitscape/pinchpointcroppolys/pinchpoint1.shp") %>% 
  st_transform(new_crs)
pp2_shp <- read_sf("../Circuitscape/pinchpointcroppolys/pinchpoint2.shp") %>% 
  st_transform(new_crs)

corridors <- raster("../Circuitscape/pinchpointoutput/addI70_corridors_truncated_at_10k1.tif")
corridors_rpj <- projectRaster(from = corridors,crs=new_crs)

pinchpoints <- raster("../Circuitscape/pinchpointoutput/addI70_current_adjacentPairs_10k1.tif")
pinchpoints_rpj <- projectRaster(from = pinchpoints,crs=new_crs)

resistance <- raster("../Circuitscape/resistance.tif")
resistance_rpj <- projectRaster(from=resistance,crs=new_crs)
```


```{r pinchpoint1}
pp1_corrs_mask <- mask(crop(corridors_rpj,extent(pp1_shp)),pp1_shp)
writeRaster(pp1_corrs_mask,"../GoatRepo/NetLogoInput/pp1_corridors.tif",overwrite=T)

pp1_pp_mask <- mask(crop(pinchpoints_rpj,extent(pp1_shp)),pp1_shp)
writeRaster(pp1_pp_mask,"../GoatRepo/NetLogoInput/pp1_pinchpoints.tif",overwrite=T)

pp1_res_mask <- mask(crop(resistance_rpj,extent(pp1_shp)),pp1_shp)
writeRaster(pp1_res_mask,"../GoatRepo/NetLogoInput/pp1_resistance.tif",overwrite=T)


pp2_corrs_mask <- mask(crop(corridors_rpj,extent(pp2_shp)),pp2_shp)
writeRaster(pp2_corrs_mask,"../GoatRepo/NetLogoInput/pp2_corrs.tif",overwrite=T)

pp2_pp_mask <- mask(crop(pinchpoints_rpj,extent(pp2_shp)),pp2_shp)
writeRaster(pp2_pp_mask,"../GoatRepo/NetLogoInput/pp2_pinchpoints.tif",overwrite=T)

pp2_res_mask <- mask(crop(resistance_rpj,extent(pp2_shp)),pp2_shp)
writeRaster(pp2_res_mask,"../GoatRepo/NetLogoInput/pp2_resistance.tif",overwrite=T)
```



